vjust = 1.5)+
xlab("Income Category")+
ylab("Proportion of Two Types of Customers")+
labs(fill = "Customer Types")+
scale_fill_manual(values = c( "#E69F00", "#56B4E9"))+
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
vjust = 1.5),
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
vjust = 1.5,
color = "white")
xlab("Income Category")+
ylab("Proportion of Two Types of Customers")+
labs(fill = "Customer Types")+
scale_fill_manual(values = c( "#E69F00", "#56B4E9"))+
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
vjust = 1.5,
color = "white")+
xlab("Income Category")+
ylab("Proportion of Two Types of Customers")+
labs(fill = "Customer Types")+
scale_fill_manual(values = c( "#E69F00", "#56B4E9"))+
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
bank_churners <- readr::read_csv("https://wilkelab.org/SDS375/datasets/bank_churners.csv")
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.89),
vjust = 1.5,
color = "white")+
xlab("Income Category")+
ylab("Proportion of Two Types of Customers")+
labs(fill = "Customer Types")+
scale_fill_manual(values = c( "#E69F00", "#56B4E9"))+
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.8),
vjust = 1.5,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
vjust = 1.5,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
vjust = 1,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = 100 * round(freq, 3)),
position = position_fill(0.9),
hjust = 1,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%"),
position = position_fill(0.9),
hjust = 1,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 1,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 1.5,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 0.9,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 0.8,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 0.95,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(1),
hjust = 0.95,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
#data prep
for_plot <- bank_churners%>%
mutate(Income_Category = fct_relevel(Income_Category,
"Less than $40K",
"$40K - $60K",
"$60K - $80K",
"$80K - $120K",
"$120K +")) %>%
filter(Income_Category != "Unknown") %>%
count(Income_Category, Attrition_Flag) %>%
group_by(Income_Category) %>% # we want freq per income category
mutate(freq = n/sum(n))
# plot
for_plot %>%
ggplot(aes(y = Income_Category, x = n, fill = Attrition_Flag)) +
geom_col(position = "fill") +
geom_text(
aes(label = paste(100 * round(freq, 3), "%")),
position = position_fill(0.9),
hjust = 0.95,
color = "white") +
xlab("Income Category") +
ylab("Proportion of Two Types of Customers") +
labs(fill = "Customer Types") +
scale_fill_manual(values = c( "#E69F00", "#56B4E9")) +
theme_minimal()+
theme(
axis.text = element_text(size = 8.5, color = "black"),
text = element_text(family = "Palatino")
)
ggplot(home_ownership_data) +
geom_sf(aes(fill = home_ownership)) +
scale_fill_continuous_sequential(palette = "Oslo", label = scales::label_percent(scale = 1)) +
theme_void()
library(knitr)
library(tidyverse)
library(sf)
library(broom)
opts_chunk$set(fig.align="center", fig.height=4.326, fig.width=7)
# data preparation
US_counties <- readRDS(url("https://wilkelab.org/SDS375/datasets/US_counties.rds")) %>%
rename(FIPS = GEOID)
# workaround for missing rgdal on edupod
st_crs(US_counties) <- NA
US_census <- read_csv(
"https://wilkelab.org/SDS375/datasets/US_census.csv",
col_types = cols(FIPS = "c")
)
home_ownership_data <- US_counties %>%
left_join(US_census, by = "FIPS")
head(table, n = 2)
ggplot(home_ownership_data) +
geom_sf(aes(fill = home_ownership)) +
scale_fill_continuous_sequential(palette = "Oslo", label = scales::label_percent(scale = 1)) +
theme_void()
library(knitr)
library(tidyverse)
library(sf)
library(broom)
library(colorspace)
opts_chunk$set(fig.align="center", fig.height=4.326, fig.width=7)
